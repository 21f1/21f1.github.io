"use strict";(self["webpackChunkface_montage"]=self["webpackChunkface_montage"]||[]).push([[413],{1413:(e,a,l)=>{l.r(a),l.d(a,{default:()=>R});var n=l(9835),i=l(1957),t=l(6970);const u={id:"p5Container"},o={id:"box"},s={class:"placeholder absolute-center"},r=(0,n._)("br",null,null,-1);function c(e,a,l,c,v,d){const h=(0,n.up)("q-spinner-hourglass"),g=(0,n.up)("q-btn"),p=(0,n.up)("q-page-sticky"),w=(0,n.up)("q-slider"),m=(0,n.up)("q-btn-group"),f=(0,n.up)("q-icon"),y=(0,n.up)("q-knob"),k=(0,n.up)("q-page"),b=(0,n.Q2)("touch-swipe");return(0,n.wg)(),(0,n.j4)(k,{id:"editor"},{default:(0,n.w5)((()=>[(0,n.wy)(((0,n.wg)(),(0,n.iD)("div",u,[(0,n.wy)((0,n._)("div",o,null,512),[[i.F8,e.drawBox]])])),[[b,e.handleSwipe,void 0,{mouse:!0}]]),(0,n.wy)((0,n._)("div",s,[(0,n.Wm)(h,{color:"warning",size:"4em"})],512),[[i.F8,!e.ready]]),e.multiple?((0,n.wg)(),(0,n.j4)(p,{key:0,position:"right"},{default:(0,n.w5)((()=>[(0,n.Wm)(g,{color:"yellow",label:"Next Face",onClick:e.nextFace},null,8,["onClick"]),r,(0,n.Wm)(g,{color:"green",label:"Set Face",onClick:e.setFace},null,8,["onClick"])])),_:1})):(0,n.kq)("",!0),(0,n.wy)((0,n.Wm)(p,{position:"bottom-left",offset:[18,18]},{default:(0,n.w5)((()=>[(0,n.Wm)(w,{modelValue:e.scaler,"onUpdate:modelValue":a[0]||(a[0]=a=>e.scaler=a),onChange:e.changeScale,min:10,markers:5,step:5,max:50,color:"green",vertical:"",reverse:"","label-always":"",snap:""},null,8,["modelValue","onChange"])])),_:1},512),[[i.F8,!e.isPlaying]]),(0,n.Wm)(p,{position:"bottom",offset:[0,18]},{default:(0,n.w5)((()=>[(0,n.Wm)(m,{push:""},{default:(0,n.w5)((()=>[(0,n.Wm)(g,{color:"yellow",glossy:"","text-color":"black",push:"",label:"Play",icon:"play_circle_filled",onClick:e.previewPlay},null,8,["onClick"]),(0,n.Wm)(g,{color:"amber",glossy:"","text-color":"black",push:"",label:"Pause",icon:"pause_circle",onClick:e.previewPause},null,8,["onClick"])])),_:1})])),_:1}),(0,n.wy)((0,n.Wm)(p,{position:"bottom-right",offset:[18,18]},{default:(0,n.w5)((()=>[(0,n.Wm)(y,{"show-value":"",modelValue:e.frameRate,"onUpdate:modelValue":a[1]||(a[1]=a=>e.frameRate=a),size:"6rem",thickness:.2,color:"orange","center-color":"grey-8","track-color":"transparent",min:4,max:10},{default:(0,n.w5)((()=>[(0,n.Wm)(f,{name:"shutter_speed"}),(0,n.Uk)(" "+(0,t.zw)(e.frameRate),1)])),_:1},8,["modelValue","thickness"])])),_:1},512),[[i.F8,!e.isPlaying]])])),_:1})}l(702),l(6727);var v=l(499),d=l(388),h=l(8910),g=l(9302),p=l(6929),w=l.n(p),m=l(9136),f=l.n(m),y=l(805);const k=(0,n.aZ)({name:"EditorPage",setup(){const e=(0,h.tv)(),a=(0,y.o)(),l=(0,g.Z)(),i=(0,v.iH)([]),t=(0,v.iH)(!1),u=(0,v.iH)(!1),o=(0,v.iH)({}),s=(0,v.iH)(),r=(0,v.iH)(!1),c=(0,v.iH)(25),p=[],m=(0,v.iH)(0),k=(0,v.iH)(1),b=(0,v.iH)(0),x=(0,v.iH)(7),H=(0,v.iH)(!1),P=(0,v.iH)(!1);let W,_,C,F,Z,q,Q,S;(0,n.bv)((async()=>{0==a.imgData.length?(l.notify({message:"Please upload images first!",progress:!0}),e.push({name:"Picker"})):B()}));const D={withLandmarks:!0,withDescriptors:!1},R=w().faceApi(D,V);async function V(){console.log("Model Loaded!")}const A=async()=>{C||(C=!0,l.dialog({title:"Alert",message:"Pictures with no faces detected. Adding to trash...",persistent:!0,dark:!0}).onDismiss((async()=>{for(let e in o.value)0==o.value[e].length&&(delete o.value[e],p.push(parseInt(e,10)));i.value=N.value,-1==i.value[0].index?(l.notify({message:"No faces detected in any image, please pick again!",progress:!0}),e.push({name:"Picker"})):(W=i.value[0].width,_=i.value[0].height,r.value=!1)})))},B=async()=>{for(let l of a.imgData){let e=new Image;e.src=l.url,R.detect(e,(async(e,a)=>{o.value[l.index]=a,0==a.length&&(r.value=!0)}))}const e=async e=>{e.preload=async l=>{for(let n of a.imgData){const a=e.loadImage(n.url);a.index=n.index,i.value.push(a)}},e.setup=async a=>{P.value=!0,e.createCanvas(window.innerWidth,window.innerHeight),W=i.value[0].width,_=i.value[0].height},e.draw=async a=>{e.clear(),e.fill("#fae"),e.rect(0,0,window.innerWidth,window.innerHeight),i.value[0].index in o.value&&!r.value?t.value?"config"in i.value[0]?e.image(i.value[0],...i.value[0].config):i.value[0].config=L.value:t.value=!0:t.value&&(t.value=!1),r.value&&A()}};new(f())(e,"p5Container")},I=async()=>{o.value[i.value[0].index].push(o.value[i.value[0].index].shift()),s.value=o.value[i.value[0].index][0].alignedRect.box,E()},z=async()=>{o.value[i.value[0].index]=[o.value[i.value[0].index].shift()],u.value=!1};(0,n.YP)(t,(async e=>{e&&(s.value=o.value[i.value[0].index][0].alignedRect.box,u.value=o.value[i.value[0].index].length>1,E())}));const U=async({evt:e,...a})=>{switch(a.direction){case"left":i.value.length>1&&(t.value=!1,i.value.push(i.value.shift()),W=i.value[0].width,_=i.value[0].height);break;case"right":i.value.length>1&&(t.value=!1,i.value.unshift(i.value.pop()),W=i.value[0].width,_=i.value[0].height);break;case"up":console.log("menu");break;case"down":console.log("close");break}},j=(0,n.Fl)((()=>({left:window.innerWidth/2-m.value/2,top:window.innerHeight/2-b.value/2,width:m.value,height:b.value,opacity:1,duration:.2}))),L=(0,n.Fl)((()=>[window.innerWidth/2-s.value.left*k.value-m.value/2,window.innerHeight/2-s.value.top*k.value-b.value/2,W*k.value,_*k.value])),N=(0,n.Fl)((()=>{const e=[];for(let a of i.value)p.includes(a.index)||e.push(a);return e.length>0?e:[{index:-1}]})),E=()=>{m.value=window.innerWidth*(c.value/100),k.value=m.value/s.value.width,b.value=k.value*s.value.height,d.ZP.to("#box",j.value),i.value[0].config=L.value},G=e=>{c.value=e,E()},K=()=>{H.value&&(requestAnimationFrame(K),Z=window.performance.now(),Q=Z-q,Q>F&&(q=Z-Q%F,i.value.length>1&&(t.value=!1,i.value.push(i.value.shift()),W=i.value[0].width,_=i.value[0].height)))},M=()=>{H.value=!0,S||(F=1e3/x.value,q=window.performance.now(),S=!0,K())},T=()=>{H.value=!1,S=!1};return{nextFace:I,setFace:z,handleSwipe:U,drawBox:t,multiple:u,scaler:c,changeScale:G,previewPlay:M,previewPause:T,frameRate:x,isPlaying:H,ready:P}}});var b=l(1639),x=l(9885),H=l(3358),P=l(627),W=l(4455),_=l(8423),C=l(7236),F=l(7788),Z=l(2857),q=l(4871),Q=l(9984),S=l.n(Q);const D=(0,b.Z)(k,[["render",c]]),R=D;S()(k,"components",{QPage:x.Z,QSpinnerHourglass:H.Z,QPageSticky:P.Z,QBtn:W.Z,QSlider:_.Z,QBtnGroup:C.Z,QKnob:F.Z,QIcon:Z.Z}),S()(k,"directives",{TouchSwipe:q.Z})}}]);